__version__ = (1, 4, 8, 8)

# This file is a part of Hikka Userbot
# Code is NOT licensed under CC-BY-NC-ND 4.0 unless otherwise specified.
# üåê https://github.com/hikariatama/Hikka

# + –ø–æ—Å—Ö–∞–ª–∫–æ

# You CAN edit this file without direct permission from the author.
# You can redistribute this file with any modifications.

# meta developer: @yg_modules
# scope: hikka_only
# scope: hikka_min 1.6.3

# ‚£ø‚£ø‚£ø‚°∑‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†ü‚†â‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚†ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£Ω‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
# ‚£ø‚£ø‚£ø‚£æ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°â‚¢ø‚£ø‚£ø‚£ø‚£ø
# ‚£π‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°õ‚†É‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†â‚†ª‚£ø‚°ü‚¢ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£Æ‚£Ω‚£ø‚£ø‚£ø
# ‚£ø‚£ø‚£ø‚£ù‚£ø‚£ø‚£ø‚£Ω‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£¶‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£†‚£æ‚£ø‚£ø‚£Ñ‚†õ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ü‚£ù‚£ø‚£ø‚£ø
# ‚£ø‚£ø‚¢∑‚£æ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚¢∑‚£ø‚£ø‚£Ø‚¢ç‚¢ª‚£ø‚£∑‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£æ‚°ø‚†õ‚†ª‚†õ‚¢ø‚°á‚¢π‚£ø‚£ø‚£ø‚£ø‚£ø‚£≥‚£Ω‚£ø‚£ø‚£ø
# ‚°ª‚†ü‚†à‚¢õ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ü‚£æ‚£ø‚£ø‚£ø‚£∑‚£º‚£ø‚£ø‚£ø‚£¶‚£§‚°Ä‚†Ñ‚†Ä‚†Ä‚†∞‚†Ä‚¢Ä‚£§‚£¥‚£ø‚£ø‚£∂‚£ß‚£§‚£Ñ‚£§‚£©‚¢∏‚£ø‚£ø‚£ø‚£ø‚°Ø‚¢ç‚£ø‚£ø‚£ø‚£ø
# ‚†Ä‚†Ä‚†Ä‚†Ä‚¢ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°á‚¢º‚£ø‚£ø‚£ø‚†ã‚£Ω‚°ü‚£ø‚£ø‚£ø‚£ø‚£ø‚£ß‚†Ä‚†Ä‚¢∏‚£æ‚£ø‚£ø‚£ø‚£ø‚£ø‚¢ø‚¢ø‚£ø‚£ø‚£ø‚°ü‚¢∏‚£ø‚£ø‚£ø‚£ø‚£∑‚°ö‚¢ø‚£ø‚£ø‚£ø
# ‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚¢â‚£ø‚£ø‚£ø‚£ø‚†É‚†ú‚†ª‚¢ø‚£ø‚£æ‚£ß‚£ã‚£ø‚£ø‚£ø‚£ø‚†ª‚†í‚†Ç‚†Ä‚¢∫‚£ø‚£ø‚£ø‚£ß‚£ß‚£õ‚¢∞‚¢º‚£æ‚£ø‚£ø‚†É‚†ò‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°è‚£ø‚£ø‚£ø
# ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢ª‚£ø‚£ø‚£ø‚†Ä‚†Ä‚†Ä‚†â‚†π‚†ø‚†ø‚¢ø‚£ø‚£ø‚†ø‚†ª‚†≥‚†Å‚†Ä‚†Ä‚†ò‚°ø‚£ø‚£ø‚£ø‚†ø‚£ø‚¢ø‚¢≠‚°Ñ‚††‚†á‚†ç‚£Ä‚£ø‚£ø‚£ø‚°â‚£©‚†û‚¢∏‚£ø‚£ø‚£ø
# ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£Ø‚£ø‚£ø‚†à‚£°‚¢Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢∞‚£∂‚†¶‚†Ä‚†Ä‚†Ä‚†Ä‚£à‚£é‚†Ä‚†à‚†Ä‚†à‚†Ä‚†Ä‚†Ä‚£Ä‚£†‚¢¥‚†Ω‚£ø‚£ø‚£ü‚¢è‚†Ç‚†Ä‚¢º‚£ø‚£ø‚£ø
# ‚†Ä‚†Å‚†Ä‚£†‚†Ç‚†Ä‚†Ä‚¢°‚¢º‚£è‚£æ‚£Ø‚†à‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£†‚°ñ‚°ø‚†â‚†É‚†Ä‚†Ä‚†Ä‚†à‚°ú‚†â‚¢ª‚£∂‚£Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚£∂‚°ü‚£®‚£ø‚£ø‚°ø‚£ü‚£ø‚¢ø‚£ø‚£ø‚°ü‚£ø‚°ø
# ‚†Ä‚†Ä‚†í‚†ã‚†Ä‚†Ä‚†Ä‚¢Ä‚†®‚¢õ‚°ø‚¢ª‚°Ü‚†Ä‚†Ä‚£†‚£¥‚†ü‚†Å‚†ò‚£º‚£§‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£¢‚£§‚£ø‚†â‚†ô‚¢∑‚£Ü‚°Ä‚†∞‚£ø‚£æ‚£ø‚£ø‚°è‚¢ª‚°ø‚†â‚£≠‚¢†‚†Ä‚¢ò‚£ø‚¢ø
# ‚†Ä‚£§‚††‚£Ä‚¢Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£µ‚†º‚£ø‚£∑‚£∂‚£ø‚£ø‚£ø‚†Ä‚†Ä‚†Ä‚†à‚¢ª‚£ø‚£Ü‚†Ä‚†Ä‚£Ä‚£ø‚†ü‚†ì‚†Ä‚†Ä‚†Ä‚£Ω‚£ø‚£ø‚£ø‚£ø‚£ø‚¢ø‚¢Ä‚°ø‚†Ä‚¢Ä‚£∞‚£§‚£†‚£∂‚£æ‚£ø
# ‚£ø‚†ü‚¢ª‚£ø‚£ø‚†Ä‚†Ä‚¢à‚†Ä‚†Ω‚†Ä‚†ò‚†ø‚£ø‚£ø‚£ø‚£ø‚£Ä‚£Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†â‚¢ø‚†õ‚†õ‚†Å‚†Ä‚†Ä‚¢Ä‚£†‚£º‚£ø‚£ø‚£ø‚£ø‚£ø‚£è‚£ø‚†ã‚†Ä‚°†‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
# ‚†â‚†Ä‚£¥‚¢¥‚†ü‚£§‚†Ü‚†Ä‚£î‚°Ä‚£Ñ‚†Ä‚†Ä‚†à‚†ò‚°ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∂‚£∂‚£§‚£Ñ‚£§‚£§‚£¥‚£æ‚£ø‚£ø‚£ø‚£ø‚£ø‚°ü‚¢ª‚†ø‚£ø‚£π‚†É‚†§‚£¥‚¢∑‚°ô‚£ø‚£ø‚£ø‚¢ø‚£ø‚£ø
# ‚†Ä‚†Ä‚¢∏‚£Ñ‚£†‚£Ñ‚°Ä‚†Ä‚†ø‚†õ‚¢Å‚††‚††‚†Ä‚¢Ä‚†Å‚†à‚£ø‚£ø‚£ø‚°ç‚†ö‚†ò‚†ã‚†ô‚°ô‚†â‚†è‚†É‚¢®‚£ø‚£ø‚£ø‚£ø‚°Ç‚†à‚£∏‚£∑‚¢ã‚¢≥‚£û‚†±‚†ê‚£ø‚£æ‚£ø‚£ü‚£¨‚£ø‚£ø
# ‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚†ø‚†Ω‚†Ä‚¢Ä‚†Ä‚†Ä‚†Ä‚£Ñ‚°Ñ‚¢∏‚£Ü‚†Ä‚¢π‚£ø‚£ø‚£ø‚†¥‚†Ä‚†Ä‚†Ä‚†á‚†Ä‚†Ñ‚†≤‚¢ª‚£ø‚£ø‚£ø‚£ø‚°è‚†Å‚£ø‚°è‚£º‚°æ‚¢â‚£Ä‚£≤‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
# ‚†Ä‚¢Ä‚¢Ä‚£Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚¢†‚£§‚°†‚¢ø‚£¥‚°Ü‚¢ª‚£¶‚†Ä‚¢ª‚£ø‚£ø‚£∂‚£§‚£§‚£Ä‚£Ä‚°Ä‚£Ñ‚£º‚£ø‚£ø‚£ø‚£ø‚£ø‚†á‚£∏‚°ø‚£Å‚†ü‚¢µ‚¢ø‚£ø‚£ø‚¢ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
# ‚†∞‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£Ä‚£¥‚£ø‚£∑‚£ø‚£ø‚£ø‚°å‚¢ø‚°Ü‚†Ä‚†ô‚¢ø‚£∑‚£Å‚†â‚†â‚†â‚†â‚£â‚£Ω‚°ø‚¢ã‚£ø‚£æ‚£ø‚£∞‚†á‚£º‚£ø‚£Ü‚°∏‚£Ø‚£ü‚£∑‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
# ‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚†Å‚†Ä‚†Ä‚£©‚£æ‚£ø‚£ø‚°á‚£ø‚£ø‚£ø‚£ø‚£ø‚°Ñ‚°Ä‚†Ä‚†Ä‚†â‚†â‚†Å‚†Å‚††‚†õ‚†õ‚†Å‚†ä‚£ø‚£ø‚£ø‚£ü‚£ø‚£ø‚£ø‚£ø‚¢∑‚°ø‚£è‚¢æ‚¢ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
# ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£æ‚£ø‚£ø‚£ø‚£ø‚£∑‚£ø‚£ø‚£ø‚£ø‚°â‚¢ª‚°Ä‚†Ä‚†Ä‚£Ä‚£§‚£§‚°§‚†¥‚†í‚†ã‚†Å‚¢†‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£æ‚£Ω‚£ø‚£ø‚£ø‚¢ø‚£ø
# ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢†‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°á‚†Ä‚†Ä‚†Ä‚†Ä‚†Ç‚†§‚†§‚†§‚†§‚†Ñ‚†Ä‚†Ä‚£æ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ç‚£∑‚†æ‚°ø‚¢ø‚¢æ‚£ø
# ‚†Ä‚†Ä‚†Ä‚†Ä‚£†‚£æ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ß‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢∏‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∂‚£±‚¢ù‚¢∫‚£ø
# ‚£∞‚£Ç‚¢¶‚£¥‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†ò‚£Ü‚†Ä‚†Ä‚†Ä‚†ò‚†Ä‚†Ä‚†Ä‚†Ä‚£à‚¢ª‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
# ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∑‚£Ω‚£¶‚£§‚£†‚£¥‚†Ä‚°§‚£†‚£∂‚£¶‚£æ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø

import re
from pytube import YouTube
from .. import loader, utils
from telethon.tl.types import MessageEntityTextUrl

@loader.tds
class yg_rickroll(loader.Module):
    """–ú–æ–¥—É–ª—å —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å—Ç—å –ª–∏ —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ä–∏–∫—Ä–æ–ª–ª –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏"""

    strings = {
        "name": "yg_rickroll",
        "no_reply": "<emoji document_id=5240241223632954241>üö´</emoji> <b>You did not reply to the message</b>",
        "no_youtube_link": "<emoji document_id=5240241223632954241>üö´</emoji> <b>No YouTube link found in the reply message</b>",
        "is_rick_roll": "<emoji document_id=5440660757194744323>‚ÄºÔ∏è</emoji> <b>A RickRoll link was found in the message</b>",
        "is_not_rick_roll": "<emoji document_id=5206607081334906820>‚úîÔ∏è</emoji> <b>No RickRoll link was found in the message</b>",
        "error": "<emoji document_id=5447644880824181073>‚ö†Ô∏è</emoji> <b>Error retrieving video information:</b> <code>{}</code>",
        "loading": "<emoji document_id=5386367538735104399>‚åõÔ∏è</emoji> <b>Loading...</b>",
        "link_arg": "<emoji document_id=5447644880824181073>‚ö†Ô∏è</emoji> <b>You need to reply to the message with a YouTube video link</b>",
        "not_found": "<emoji document_id=5240241223632954241>üö´</emoji> <b>YouTube video link not found</b>"
    }

    strings_ru = {
        "no_reply": "<emoji document_id=5240241223632954241>üö´</emoji> <b>–í—ã –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª–∏ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ</b>",
        "no_youtube_link": "<emoji document_id=5240241223632954241>üö´</emoji> <b>–í –æ—Ç–≤–µ—Ç–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ —Å—Å—ã–ª–∫–∏ –Ω–∞ YouTube</b>",
        "is_rick_roll": "<emoji document_id=5440660757194744323>‚ÄºÔ∏è</emoji> <b>–í —Å–æ–æ–±—â–µ–Ω–∏–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ RickRoll</b>",
        "is_not_rick_roll": "<emoji document_id=5206607081334906820>‚úîÔ∏è</emoji> <b>–í —Å–æ–æ–±—â–µ–Ω–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ —Å—Å—ã–ª–∫–∏ –Ω–∞ RickRoll</b>",
        "error": "<emoji document_id=5447644880824181073>‚ö†Ô∏è</emoji> <b>–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –≤–∏–¥–µ–æ:</b> <code>{}</code>",
        "loading": "<emoji document_id=5386367538735104399>‚åõÔ∏è</emoji> <b>–ó–∞–≥—Ä—É–∑–∫–∞...</b>",
        "link_arg": "<emoji document_id=5447644880824181073>‚ö†Ô∏è</emoji> <b>–í–∞–º –Ω—É–∂–Ω–æ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ YouTube —Ä–æ–ª–∏–∫</b>",
        "not_found": "<emoji document_id=5240241223632954241>üö´</emoji> <b>–ù–µ –Ω–∞–π–¥–µ–Ω–æ —Å—Å—ã–ª–∫–∏ –Ω–∞ YouTube —Ä–æ–ª–∏–∫</b>"
    }

    async def rickcmd(self, message):
        """<reply> - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å—Ç—å –ª–∏ —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ä–∏–∫—Ä–æ–ª–ª –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏"""
        reply = await message.get_reply_message()
        if not reply:
            await utils.answer(message, self.strings("no_reply"))
            return
        
        url = self.extract_youtube_url(reply)
        if not url:
            await utils.answer(message, self.strings("no_youtube_link"))
            return
        
        try:
            video = YouTube(url)
            if "Never Gonna Give You Up" in video.title:
                await utils.answer(message, self.strings("is_rick_roll"))
            else:
                await utils.answer(message, self.strings("is_not_rick_roll"))
        except Exception as e:
            await utils.answer(message, self.strings("error").format(str(e)))

    def extract_youtube_url(self, message):
        """Extract YouTube URL from the message entities or text"""
        youtube_regex = r'(https?://(?:www\.)?youtube\.com/watch\?v=[\w-]+|https?://youtu\.be/[\w-]+|https?://m\.youtube\.com/watch\?v=[\w-]+|https?://youtube\.tv/watch\?v=[\w-]+)'
        
        if message.entities:
            for entity in message.entities:
                if isinstance(entity, MessageEntityTextUrl):
                    if re.match(youtube_regex, entity.url):
                        return entity.url
        
        match = re.search(youtube_regex, message.raw_text)
        if match:
            return match.group(0)
        
        return None